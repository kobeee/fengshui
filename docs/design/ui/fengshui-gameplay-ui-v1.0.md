# Feng Shui: 8-Bit Harmony — UI & Gameplay Design Spec (v1.0)

## 1. 文档目标

本规范用于统一以下三件事：

1. **玩法闭环**：拖动罗盘巡检房间 → 触发煞点事件 → 选择正确处置 → 全部净化通关。
2. **双端适配**：同一玩法语义，移动端与桌面端都成立。
3. **视觉统一**：UI 为“低饱和像素容器”，让模型生图成为主角，避免 UI 抢戏。

---

## 2. 核心玩法（强化版）

## 2.1 一句话循环

玩家在一张全屏房间图内拖动罗盘扫描，当罗盘靠近煞点时发生“转速异常”，触发处置弹窗；清理全部煞点后切换暖色通关图并进入下一关。

## 2.2 状态机

- `scan_idle`：正常扫描（罗盘常速）
- `scan_alert`：接近煞点（罗盘加速 + 提示）
- `event_modal`：弹出事件与选项
- `resolve_correct`：煞点净化，房间局部改善
- `resolve_wrong`：惩罚反馈（可增加煞气/扣分）
- `all_cleansed`：全部净化，触发暖色通关图
- `level_transition`：展示“下一关”入口

## 2.3 罗盘交互规则

- 罗盘为可拖动对象，允许在房间图范围内自由移动。
- 每个煞点有探测半径：
  - 半径外：常速
  - 半径边缘：轻微加速
  - 半径核心：高速旋转 + 触发事件
- 提示只在接近时出现，避免信息噪音。

## 2.4 事件弹窗规则

每个煞点弹窗包含：

- 问题标题（例如：镜冲床、尖角煞、门冲）
- 场景描述（简洁，1~2 行）
- 3 个选项（至少 1 个正确，1 个迷惑项）
- `确认处置` 按钮

反馈：

- 正确：该煞点状态改为已净化，局部视觉转暖。
- 错误：给出错误反馈，可选惩罚（如煞气值+1 / 评分降低）。

## 2.5 胜负条件

- 通关：关卡内所有煞点均被正确处置。
- 失败（可选）：错误次数超限或煞气值溢出。
- 通关后：
  - 房间图执行冷→暖色板切换
  - 弹出 `下一关` 入口

---

## 3. 关卡结构建议

每关维护：

- `roomImageCold`：冷色底图（模型图）
- `roomImageWarm`：通关暖色图（模型图）
- `shaPoints[]`：煞点列表
  - `id`
  - `type`
  - `position` (x,y)
  - `radius`
  - `prompt`
  - `options[]`
  - `correctOptionId`
  - `resolved`

建议首关目标：3~4 个煞点，3 次错误容忍。

---

## 4. UI 结构规范（Mobile + Web）

## 4.1 Mobile（竖屏优先）

- 顶部：关卡信息（Stage、已净化计数）
- 中部：**全屏房间图主视区**（最高优先级）
- 中层交互：罗盘 + 接近提示
- 事件层：底部/中部弹窗（不离开当前房间）
- 底部：关键按钮（确认处置、玩法）

## 4.2 Web（宽屏）

- 左/右分栏可用，但房间图仍是主体。
- 推荐：
  - 主图区域占大头
  - 事件面板在侧栏展示（更利于阅读与选择）

## 4.3 Feed Splash

- 只承担“引导进入 Expanded”职责。
- 不放重玩法逻辑，不堆信息。
- 以单 CTA 为主：`展开游玩`。

---

## 5. 视觉策略（与模型图协同）

## 5.1 核心原则

- UI 用**低饱和中性色**作为容器与框线。
- 强调色控制在 1 个主暖色（赭金系）。
- 模型图负责“风格表达”，UI 负责“信息秩序”。

## 5.2 基础色建议（可继续微调）

- 背景深色：`#0E1116` / `#151A22`
- 面板中性：`#202736`
- 图像占位灰蓝：`#616C80`
- 主文字浅灰：`#D0D6E1`
- 次文字灰：`#AAB3C2`
- 强调金：`#C4A06A`
- 强调金深：`#A8834E`

## 5.3 像素文字策略（中文）

- 当前视觉稿使用 `DotGothic16` 落地“像素感中文”。
- 后续可升级为：
  - 方案 A：中文标题位图化（Sprite）
  - 方案 B：自备 CJK 像素字体 WebFont

---

## 6. 模型生图接入规范

为保证 UI 不跳脱，建议每张模型图走统一后处理：

1. 限色（32~64 色）
2. 缩小再最近邻放大（统一像素格）
3. 输出冷/暖两套版本（或通关时做色板映射）

并为每关额外提供热点 JSON（煞点坐标、半径、文案）。

---

## 7. Devvit 实现映射

- Feed 入口：`splash.html`（inline）
- 游戏入口：`game.html`（expanded）
- 进入方式：`requestExpandedMode(..., "game")`

说明：Devvit 提供视图模式能力，不会替你完成业务级响应式布局；移动端与桌面端布局需在前端自行实现。

---

## 8. 当前视觉稿落位（Pencil）

文件：`fengshui.pen`

- 总板：`Responsive Showcase / Mobile + Web`（`oWk3T`）
- 启动页（双端两行）：已完成
- 新增玩法流：`Row / Gameplay Flow`（`SIABn`）
  - Mobile 玩法稿：`Mobile Gameplay / Modal Trigger`（`HkGmS`）
  - Web 玩法稿：`Web Gameplay / Modal Trigger`（`z9kHA`）
  - 四步闭环条：`4-STEP FLOW`

---

## 9. 实装优先级（建议）

1. **P0**：罗盘拖动 + 煞点探测 + 弹窗选择 + 通关切图
2. **P1**：错误惩罚/评分系统 + 下一关衔接
3. **P2**：更细粒度 VFX（微粒子、轻反馈动画、音效分层）

---

## 10. 验收清单

- [ ] Mobile / Web 均可完整跑通“扫描→弹窗→净化→通关”。
- [ ] 房间图在两端都保持主视觉地位。
- [ ] 弹窗选项可清晰区分，正确反馈明确。
- [ ] 全部煞点净化后必然触发暖色通关图。
- [ ] Splash 不承载重逻辑，仅负责转化进入游戏。
- [ ] UI 与模型图同屏时无明显风格冲突。
