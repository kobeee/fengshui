# 关卡总体规划 (Levels Master Plan)

## 版本信息

| 属性 | 值 |
|-----|-----|
| **版本** | v1.2 |
| **创建日期** | 2026-02-22 |
| **更新日期** | 2026-02-22 |
| **状态** | 房间尺寸递进规范已添加 |

---

## 一、难度递进体系

### 煞气点数量递进

| 关卡范围 | 煞气点数 | 难度等级 | 场景复杂度 |
|---------|---------|---------|-----------|
| Level 1 | 1 | 入门教程（最简单） | 单间公寓 |
| Level 2-3 | 1-2 | 入门续篇 | 单间公寓 |
| Level 4-6 | 2 | 进阶 | 单间公寓 |
| Level 7-10 | 3 | 中级 | 单间/开放式 |
| Level 11-15 | 4-5 | 高级 | 开放式/Loft |
| Level 16-20 | 5-7 | 大师 | 复式/办公室/多楼层 |

### ⚠️ 难度曲线说明（重要）

**Level 1 的特殊性**：
- Level 1 只有 1 个煞气点，是游戏最简单的教程关
- **实际上**，Level 1 是带 UI 引导的教程关，手把手教玩家操作
- 玩家有明确提示和引导，实际难度低于独立闯关的 Level 2-3
- Level 2-6 是"独立练习"，玩家需要自己判断，挑战性更高

**建议**：在 Level Select 页面标注 Level 1 为"教程关"，Level 2-6 为"独立挑战"

### 难度维度

1. **煞气点数量**：越多越难识别
2. **道具复杂度**：单一道具 → 组合道具 → 无道具操作
3. **场景复杂度**：单间 → 开放式 → 复式 → 多楼层
4. **煞气类型**：常见 → 罕见 → 组合煞气
5. **视觉干扰**：整洁 → 杂乱 → 多装饰
6. **选项复杂度**：简单干扰 → 跨煞气干扰 → 部分正确选项

---

## 二、房间尺寸递进体系（v1.2 新增）

### 设计原则

**核心问题**：前期关卡煞气点少，房间小没问题；后期关卡煞气点多，房间应更大更复杂，体现难度递进。

**解决方案**：通过图片宽高比和空间描述递进，让玩家感受到从小房间到大空间的视觉变化。

### 房间尺寸分级

| 尺寸等级 | 宽高比 | 图片尺寸 | 可视面积 | 适用关卡 |
|---------|-------|---------|---------|---------|
| **COMPACT** | 16:9 | 1376×768 | 15-30m² | Level 1-6 |
| **MEDIUM** | 2:1 | 1536×768 | 35-50m² | Level 7-10 |
| **LARGE** | 2:1 | 1600×800 | 55-80m² | Level 11-15 |
| **EXPANSIVE** | 2.5:1 | 1920×768 | 90-150m² | Level 16-20 |

### 各阶段详细说明

#### Phase 1: 入门篇（Level 1-3）- COMPACT

| 属性 | 说明 |
|-----|------|
| 宽高比 | 16:9 |
| 空间特点 | 紧凑单间，所有家具近距离可见 |
| 可视面积 | 15-22m² |
| 玩家感受 | "这是一个小房间，容易找到问题" |

#### Phase 2: 进阶篇（Level 4-6）- COMPACT

| 属性 | 说明 |
|-----|------|
| 宽高比 | 16:9 |
| 空间特点 | 小型公寓房间，略有分区但空间仍紧凑 |
| 可视面积 | 22-30m² |
| 玩家感受 | "和前面差不多大，但更熟悉了" |

#### Phase 3: 中级篇（Level 7-10）- MEDIUM

| 属性 | 说明 |
|-----|------|
| 宽高比 | 2:1 |
| 空间特点 | 明显分区（卧室+客厅/开放式布局），需要扫视更多区域 |
| 可视面积 | 35-50m² |
| 玩家感受 | "房间变大了，需要更多时间观察" |

#### Phase 4: 高级篇（Level 11-15）- LARGE

| 属性 | 说明 |
|-----|------|
| 宽高比 | 2:1 |
| 空间特点 | 多功能区域（Loft、大型工作室、办公室），4-5个煞气点分布在不同区域 |
| 可视面积 | 55-80m² |
| 玩家感受 | "这是一个大空间，煞气点分散在各处" |

#### Phase 5: 大师篇（Level 16-20）- EXPANSIVE

| 属性 | 说明 |
|-----|------|
| 宽高比 | 2.5:1 |
| 空间特点 | 超大空间（复式、别墅、高管办公室），多楼层/多区域/外部煞气可见 |
| 可视面积 | 90-150m² |
| 玩家感受 | "这是终极挑战，空间最大，问题最多" |

### 提示词描述规范

每个关卡的 room-cold 提示词必须包含以下维度：

```
ROOM SCALE: [COMPACT|MEDIUM|LARGE|EXPANSIVE] (~XX square meters, description)

SPATIAL COMPLEXITY: 详细描述空间复杂度、分区情况、特殊结构
```

### 视觉递进效果

| 关卡 | 图片宽度 | 煞气点 | 视觉感受 |
|-----|---------|-------|---------|
| L1-3 | 1376px | 1-2 | 小房间，一目了然 |
| L4-6 | 1376px | 2 | 小房间，稍微复杂 |
| L7-10 | 1536px | 3 | 中等空间，需要观察 |
| L11-15 | 1600px | 4-5 | 大空间，多区域 |
| L16-20 | 1920px | 5-7 | 超大空间，终极挑战 |

**玩家体验**：从 1376px 到 1920px，宽度增加 40%，配合空间描述，感受明显变大。

---

## 四、关卡清单（共 20 关）

### Phase 1: 入门篇（Level 1-3）

| 关卡 | 名称 | 场景 | 煞气点 | 核心教学 |
|-----|------|------|--------|---------|
| 1 | 开发者的地牢 | 单身公寓 | 1 | 横梁压顶（单一教程） |
| 2 | 猫奴的卧室 | 单身公寓 | 1-2 | 镜冲床 + 横梁（强化版） |
| 3 | 学生宿舍 | 狭窄宿舍 | 2 | 横梁压顶 + 尖角煞 |

### Phase 2: 进阶篇（Level 4-6）

| 关卡 | 名称 | 场景 | 煞气点 | 核心教学 |
|-----|------|------|--------|---------|
| 4 | 猫奴的客厅 | 公寓客厅 | 2 | 门冲 + 味煞 |
| 5 | 游戏宅卧室 | 卧室 | 2 | 横梁压顶 + 尖角煞 |
| 6 | 创业工作室 | 小型办公室 | 2 | 背门煞 + 柱角煞 |

### Phase 3: 中级篇（Level 7-10）

| 关卡 | 名称 | 场景 | 煞气点 | 核心教学 |
|-----|------|------|--------|---------|
| 7 | 小夫妻婚房 | 一室一厅 | 3 | 镜冲床 + 门冲 + 尖角煞 |
| 8 | 开放式厨房公寓 | 开放式公寓 | 3 | 灶台冲门 + 穿堂煞 + 横梁 |
| 9 | 阁楼房间 | 斜顶阁楼 | 3 | 斜顶压床 + 窗户煞 + 阴煞 |
| 10 | 老人的卧室 | 简朴卧室 | 3 | 厕所门冲 + 横梁 + 阴煞 |

### Phase 4: 高级篇（Level 11-15）

| 关卡 | 名称 | 场景 | 煞气点 | 核心教学 |
|-----|------|------|--------|---------|
| 11 | 开放式Loft | Loft公寓 | 4 | 楼梯冲门 + 穿堂煞 + 厨房煞 + 横梁 |
| 12 | 程序员工位 | 办公工位 | 4 | 背门煞 + 柱角煞 + 电线煞 + 财位问题 |
| 13 | 小型办公室 | 10人办公室 | 4 | 门冲 + 横梁 + 财位 + 尖角煞 |
| 14 | 儿童房 | 儿童卧室 | 4 | 横梁 + 镜煞 + 尖角煞 + 门冲 |
| 15 | 艺术家工作室 | 画室/工作室 | 5 | 综合煞气 + 阴阳失衡 |

### Phase 5: 大师篇（Level 16-20）

| 关卡 | 名称 | 场景 | 煞气点 | 核心教学 |
|-----|------|------|--------|---------|
| 16 | 瑜伽工作室 | 禅意空间 | 5 | 阴煞 + 尖角煞 + 窗户煞 + 财位 + 味煞 |
| 17 | 复式公寓（上） | 二层卧室 | 5 | 横梁 + 镜煞 + 楼梯下煞 + 阴煞 + 天斩煞 |
| 18 | 别墅客厅 | 大型客厅 | 6 | 路冲煞 + 天斩煞 + 财位 + 门冲 + 壁炉煞 + 反弓煞 |
| 19 | 企业老板办公室 | 高管办公室 | 6 | 背门煞 + 壁刀煞 + 财位 + 横梁 + 窗户煞 + 味煞 |
| 20 | 风水大考 | 综合场景 | 7 | 终极考验：含大师级煞气 |

---

## 四、煞气类型总览

### 基础煞气（Level 1-6）

| 类型 ID | 中文名称 | 化解方式 | 道具需求 | 出现次数 |
|--------|---------|---------|---------|---------|
| `mirror_sha` | 镜冲床 | 旋转镜子 | 无（操作） | 5次 |
| `beam_sha` | 横梁压顶 | 挂葫芦 | 葫芦 | 8次 ↓ |
| `sharp_corner_sha` | 尖角煞 | 放阔叶绿植 | 阔叶绿植 | 7次 ↓ |
| `door_clash` | 穿堂煞/门冲 | 放屏风 | 屏风 | 6次 ↓ |

### 进阶煞气（Level 7-10）

| 类型 ID | 中文名称 | 化解方式 | 道具需求 | 出现次数 |
|--------|---------|---------|---------|---------|
| `smell_sha` | 味煞/厕所门冲 | 门帘 + 移开脏物 | 门帘、金蟾 | 5次 |
| `back_door_sha` | 背门煞 | 调整座位/靠山 | 屏风、龙龟 | 3次 |
| `pillar_sha` | 柱角煞 | 阔叶绿植 | 阔叶绿植 | 3次 |
| `window_sha` | 窗户煞/光煞 | 窗帘/绿植 | 窗帘、绿植 | 4次 |
| `yin_sha` | 阴煞/阴阳失衡 | 增加光线 | 盐灯、暖灯 | 6次 |

### 高级煞气（Level 11-15）

| 类型 ID | 中文名称 | 化解方式 | 道具需求 | 出现次数 |
|--------|---------|---------|---------|---------|
| `stair_clash` | 楼梯冲门 | 屏风/绿植 | 屏风、绿植 | 4次 |
| `kitchen_sha` | 灶台冲门 | 移灶台/屏风 | 屏风 | 2次 |
| `wealth_sha` | 财位问题 | 清理 + 招财物 | 金蟾、招财猫 | 6次 |
| `electric_sha` | 电线煞/电磁煞 | 铜葫芦 | 铜葫芦 | 1次 |
| `slanted_ceiling` | 斜顶压床 | 床位移开 | 无（操作） | 1次 |

### 大师煞气（Level 16-20）

| 类型 ID | 中文名称 | 化解方式 | 道具需求 | 出现次数 |
|--------|---------|---------|---------|---------|
| `road_clash` | 路冲煞 | 八卦镜/石敢当 | 八卦镜、石敢当 | 1次 |
| `sky_split` | 天斩煞 | 山海镇/麒麟 | 山海镇、麒麟 | 2次 |
| `reverse_bow` | 反弓煞 | 石敢当/绿植 | 石敢当、绿植 | 1次 |
| `wall_blade` | 壁刀煞 | 八卦镜/绿植 | 八卦镜、绿植 | 1次 |
| `fireplace_sha` | 壁炉煞 | 绿植/水景 | 绿植 | 1次 |

---

## 五、选项多样化方案

### 问题：选项模板化

同类煞气的选项千篇一律，玩家容易"背答案"。

### 解决方案：多套选项模板

#### 镜冲床选项库（3套）

```yaml
# 套装A（基础）
options:
  - label: "用布盖住镜子"
    correct: false
  - label: "旋转镜子方向"
    correct: true
  - label: "在镜子前放绿植"
    correct: false

# 套装B（跨煞气干扰）
options:
  - label: "挂葫芦化解"
    correct: false  # 这是横梁的正确答案
  - label: "旋转镜子方向"
    correct: true
  - label: "放屏风遮挡"
    correct: false  # 这是门冲的正确答案

# 套装C（幽默+干扰）
options:
  - label: "让猫把镜子打翻"
    correct: false
  - label: "旋转镜子方向"
    correct: true
  - label: "用贴纸遮住镜面"
    correct: false
```

#### 横梁压顶选项库（3套）

```yaml
# 套装A（基础）
options:
  - label: "挂葫芦化解"
    correct: true
  - label: "把床移开"
    correct: false
  - label: "贴装饰遮挡"
    correct: false

# 套装B（跨煞气干扰）
options:
  - label: "挂葫芦化解"
    correct: true
  - label: "放屏风阻隔"
    correct: false  # 门冲答案
  - label: "放绿植"
    correct: false  # 尖角煞答案

# 套装C（幽默）
options:
  - label: "挂葫芦化解"
    correct: true
  - label: "在横梁上装RGB灯带"
    correct: false
  - label: "假装看不见横梁"
    correct: false
```

#### 门冲选项库（3套）

```yaml
# 套装A（基础）
options:
  - label: "放置屏风阻隔"
    correct: true
  - label: "常年关门"
    correct: false
  - label: "门口放地垫"
    correct: false

# 套装B（跨煞气干扰）
options:
  - label: "放置屏风阻隔"
    correct: true
  - label: "挂葫芦化解"
    correct: false  # 横梁答案
  - label: "放绿植"
    correct: false  # 尖角煞答案

# 套装C（幽默）
options:
  - label: "放置屏风阻隔"
    correct: true
  - label: "用风水APP算一下"
    correct: false
  - label: "把门封上"
    correct: false
```

### 选项分配规则

1. **Level 1-6**：使用套装A（基础），让玩家熟悉正确答案
2. **Level 7-15**：混合使用套装A和B，加入跨煞气干扰
3. **Level 16-20**：优先使用套装B和C，加入幽默选项

---

## 六、道具系统总览

### 化煞类道具

| 道具 ID | 中文名称 | 解决的煞气类型 | 备注 |
|--------|---------|--------------|------|
| `gourd` | 葫芦 | 横梁压顶、病符位 | 悬挂态，带红绳 |
| `plant-broad` | 阔叶绿植 | 尖角煞、柱角煞、多种煞气 | 盆栽，中等尺寸 |
| `screen` | 屏风 | 门冲、穿堂煞、背门煞 | 三折式，木质框 |
| `curtain` | 门帘/窗帘 | 味煞、窗户煞 | 半透明，暖色调 |
| `salt-lamp` | 盐灯 | 阴煞、阴阳失衡 | 暖色光 |
| `copper-gourd` | 铜葫芦 | 电磁煞、味煞 | 金属质感 |

### 招财类道具

| 道具 ID | 中文名称 | 用途 | 备注 |
|--------|---------|------|------|
| `money-toad` | 金蟾 | 财位招财 | 带金币，头朝内 |
| `lucky-cat` | 招财猫 | 财位招财 | 挥手动画 |
| `pi-xiu` | 貔貅 | 招财守财 | 头朝外 |
| `five-coins` | 五帝钱 | 招财化煞 | 串状 |
| `crystal-ball` | 水晶球 | 净化气场 | 透明/黄色 |

### 镇宅类道具

| 道具 ID | 中文名称 | 用途 | 备注 |
|--------|---------|------|------|
| `bagua-mirror` | 八卦镜 | 反射煞气 | 凸面镜 |
| `shan-hai-zhen` | 山海镇 | 镇宅化煞 | 挂件 |
| `stone-tablet` | 石敢当 | 挡煞镇宅 | 石质摆件 |
| `kylin` | 麒麟 | 化解小人 | 一对 |
| `dragon-turtle` | 龙龟 | 稳宅化煞 | 金色/铜色 |

### 操作类（无需道具）

| 操作 ID | 中文名称 | 解决的煞气类型 |
|--------|---------|--------------|
| `rotate-mirror` | 旋转镜子 | 镜冲床 |
| `move-bed` | 移动床铺 | 斜顶压床 |
| `clean-area` | 清理财位 | 财位问题 |
| `adjust-lighting` | 调整照明 | 阴煞 |

---

## 七、场景主题规划

### 居住空间

| 场景类型 | 适用关卡 | 视觉特点 |
|---------|---------|---------|
| 单身公寓 | 1, 2 | 小型、杂乱、现代 |
| 学生宿舍 | 3 | 狭窄、双层床、书桌多 |
| 公寓客厅 | 4 | 开放、沙发、电视柜 |
| 卧室 | 5, 10, 14 | 床、衣柜、床头柜 |
| 小型办公室 | 6 | 工位、文件柜、白板 |
| 一室一厅 | 7 | 卧室+客厅连通 |
| 开放式公寓 | 8 | 厨房+客厅+卧室一体 |
| 阁楼 | 9 | 斜顶、天窗、低矮 |
| Loft | 11 | 挑高、楼梯、开放式 |

### 商业空间

| 场景类型 | 适用关卡 | 视觉特点 |
|---------|---------|---------|
| 办公工位 | 12 | 电脑、文件、植物 |
| 10人办公室 | 13 | 多工位、会议室 |
| 艺术家工作室 | 15 | 画架、颜料、杂乱 |
| 瑜伽工作室 | 16 | 禅意、绿植、落地窗 |
| 高管办公室 | 19 | 大型、豪华、落地窗 |

### 高级场景

| 场景类型 | 适用关卡 | 视觉特点 |
|---------|---------|---------|
| 复式公寓 | 17 | 楼梯、两层连通 |
| 别墅客厅 | 18 | 大型、壁炉、落地窗、庭院视野 |
| 综合场景 | 20 | 多区域、高复杂度 |

---

## 八、提示词设计原则

基于 Gemini Nano Banana Pro 最佳实践：

### 1. 多物体遵从性策略

**问题**：煞气点越多，AI 遵从性越低

**解决方案**：
- 使用"详细列表法"明确列出每个煞气元素
- 使用空间关系词（ZONE A/B/C/D）明确位置
- 先生成简洁底图，后续通过 img2img 添加细节

### 2. 煞气点数量限制建议

| 煞气点数 | 推荐策略 |
|---------|---------|
| 1-2 个 | 直接生成，高遵从性 |
| 3-4 个 | 详细空间描述 + 分区域列举 |
| 5-6 个 | 分层生成：底图 → 煞气元素叠加 |
| 7+ 个 | 多图拼接或运行时合成 |

### 3. 冷/暖色调控制

**冷色底图关键词**：
```text
Cool color palette, desaturated tones, blue-grey tones
Moody atmosphere, dim lighting, overcast
Color scheme: blues, greys, muted greens
```

**暖色终图关键词**：
```text
Warm color palette, golden hour lighting
Color scheme: oranges, yellows, warm browns
Cozy atmosphere, sun-drenched, inviting
```

---

## 九、生成顺序建议

### 推荐生成流程

1. **先设计关卡** → 确定煞气类型和道具
2. **生成冷色底图** → 包含所有煞气场景
3. **生成道具 PNG** → 透明背景
4. **生成暖色终图** → img2img，道具已放置
5. **AI 分析** → 生成 hotspots.json
6. **验证** → 检查煞气点位置和选项

### 批量生成建议

- 同类型道具可复用（如阔叶绿植）
- 基础道具库优先完成
- 后续关卡可复用已有道具

---

## 十、验收标准

### 关卡设计验收

- [x] 关卡名称和场景符合主题
- [x] 煞气点数量符合难度递进
- [x] 每个煞气点有 3 个选项
- [x] 道具需求明确
- [ ] 提示词结构完整（待补充）
- [ ] 选项多样化（待实施）

### 文档结构验收

- [x] 每个关卡独立目录
- [x] level-design.md 完整
- [ ] prompts/ 目录完整（待补充）
- [ ] analysis/ 目录完整（待补充）

---

## 十一、评审记录

### Review #1 (2026-02-22)

**评审人**: Oracle  
**评分**: 6.5/10

**优势**:
1. 风水知识准确，符合传统理论
2. 叙事贴近生活，容易引起共鸣
3. 道具复用策略合理
4. 文档结构规范

**关键问题**:
1. 🔴 难度曲线倒退 - Level 1 有 4 个煞气，Level 2-3 只有 1 个
2. 🔴 选项模板化严重 - 同类煞气选项千篇一律
3. 🟡 横梁和门冲出现次数过多（30%+）
4. 🟡 大师煞气未使用 - Level 16-20 缺少高级煞气
5. 🟡 Level 16 与 Level 11 场景重复

**修复状态**:
- [x] 难度曲线说明 - 已在本文档添加说明
- [x] 选项多样化方案 - 已设计 3 套选项模板
- [x] 大师煞气补充 - Level 18-20 已加入路冲/天斩/反弓/壁刀
- [x] Level 16 场景替换 - 改为瑜伽工作室
- [x] 关卡文档更新 - Level 16/18/19/20 已按规划修复

---

### Review #2 (2026-02-22)

**评审人**: Oracle
**评分**: 7.2/10

**修复验证**:
| 问题 | 修复状态 |
|-----|--------|
| Level 16 场景改为瑜伽工作室 | ✅ 已修复 |
| Level 18 加入天斩煞/路冲煞/反弓煞 | ✅ 已修复 |
| Level 19 加入壁刀煞 | ✅ 已修复 |
| Level 20 加入天斩煞/反弓煞 | ✅ 已修复 |
| 选项多样化应用 | ⚠️ 未完全应用 |

**剩余问题**:
- 选项模板化问题：各关卡选项仍为基础模板，未应用多样化方案
- 这是可选优化项，不影响关卡核心设计

**设计亮点**:
- 难度曲线合理（1→7个煞气点）
- 场景多样性丰富（公寓/宿舍/办公室/Loft/别墅等）
- 叙事贴近生活
- 道具复用策略优秀
- 大师级煞气引入增强后期挑战性

---

## 版本记录

| 版本 | 日期 | 变更说明 |
|-----|------|---------|
| v1.1 | 2026-02-22 | 根据评审反馈：添加难度曲线说明、选项多样化方案、大师煞气补充、Level 16 场景调整 |
| v1.0 | 2026-02-22 | 初版总体规划 |
